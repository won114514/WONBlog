import{o as fe,i as ue,I as H,b as Q,r as X,h as de,a as ve}from"./Icon.DJAiPuP0.js";import{j as he,k as P,n as pe,g as p,o as ge,q as me,H as xe,u as W,v as Z,w as U,x as z,C as be,y as _e,z as j,A as we,B as ee,E as $,D as G,F as ke,G as te,m as V,I as K,J as ye,K as Ee,L as Se,M as Ce,N as ie,O as oe,P as Y,Q as Te,R as Ie,S as Le,l as re,a as Me,f as ce,T as Ae,e as ne,b as ae,p as Ne,h as M,c as Re,d as A,r as N,s as q,t as $e,U as B,i as le}from"./render.CPyDDka7.js";import{u as Oe}from"./url-utils.uEDIkcjJ.js";/* empty css                        */function Pe(t,i){return i}function qe(t,i,a){for(var g=[],x=i.length,h,u=i.length,r=0;r<x;r++){let f=i[r];oe(f,()=>{if(h){if(h.pending.delete(f),h.done.add(f),h.pending.size===0){var E=t.outrogroups;J(K(h.done)),E.delete(h),E.size===0&&(t.outrogroups=null)}}else u-=1},!1)}if(u===0){var s=g.length===0&&a!==null;if(s){var o=a,d=o.parentNode;Ie(d),d.append(o),t.items.clear()}J(i,!s)}else h={pending:new Set(i),done:new Set},(t.outrogroups??=new Set).add(h)}function J(t,i=!0){for(var a=0;a<t.length;a++)Le(t[a],i)}var se;function De(t,i,a,g,x,h=null){var u=t,r=new Map;P&&pe();var s=null,o=ge(()=>{var m=a();return ye(m)?m:m==null?[]:K(m)}),d,f=!0;function E(){e.fallback=s,Fe(e,d,u,i,g),s!==null&&(d.length===0?(s.f&$)===0?ie(s):(s.f^=$,D(s,null,u)):oe(s,()=>{s=null}))}var I=he(()=>{d=p(o);var m=d.length;let T=!1;if(P){var S=me(u)===xe;S!==(m===0)&&(u=W(),Z(u),U(!1),T=!0)}for(var b=new Set,C=we,L=ke(),l=0;l<m;l+=1){P&&z.nodeType===be&&z.data===_e&&(u=z,T=!0,U(!1));var c=d[l],v=g(c,l),n=f?null:r.get(v);n?(n.v&&j(n.v,c),n.i&&j(n.i,l),L&&C.skipped_effects.delete(n.e)):(n=He(r,f?u:se??=ee(),c,v,l,x,i,a),f||(n.e.f|=$),r.set(v,n)),b.add(v)}if(m===0&&h&&!s&&(f?s=G(()=>h(u)):(s=G(()=>h(se??=ee())),s.f|=$)),P&&m>0&&Z(W()),!f)if(L){for(const[w,_]of r)b.has(w)||C.skipped_effects.add(_.e);C.oncommit(E),C.ondiscard(()=>{})}else E();T&&U(!0),p(o)}),e={effect:I,items:r,outrogroups:null,fallback:s};f=!1,P&&(u=z)}function Fe(t,i,a,g,x){var h=i.length,u=t.items,r=t.effect.first,s,o=null,d=[],f=[],E,I,e,m;for(m=0;m<h;m+=1){if(E=i[m],I=x(E,m),e=u.get(I).e,t.outrogroups!==null)for(const n of t.outrogroups)n.pending.delete(e),n.done.delete(e);if((e.f&$)!==0)if(e.f^=$,e===r)D(e,null,a);else{var T=o?o.next:r;e===t.effect.last&&(t.effect.last=e.prev),e.prev&&(e.prev.next=e.next),e.next&&(e.next.prev=e.prev),R(t,o,e),R(t,e,T),D(e,T,a),o=e,d=[],f=[],r=o.next;continue}if((e.f&Y)!==0&&ie(e),e!==r){if(s!==void 0&&s.has(e)){if(d.length<f.length){var S=f[0],b;o=S.prev;var C=d[0],L=d[d.length-1];for(b=0;b<d.length;b+=1)D(d[b],S,a);for(b=0;b<f.length;b+=1)s.delete(f[b]);R(t,C.prev,L.next),R(t,o,C),R(t,L,S),r=S,o=L,m-=1,d=[],f=[]}else s.delete(e),D(e,r,a),R(t,e.prev,e.next),R(t,e,o===null?t.effect.first:o.next),R(t,o,e),o=e;continue}for(d=[],f=[];r!==null&&r!==e;)(s??=new Set).add(r),f.push(r),r=r.next;if(r===null)continue}(e.f&$)===0&&d.push(e),o=e,r=e.next}if(t.outrogroups!==null){for(const n of t.outrogroups)n.pending.size===0&&(J(K(n.done)),t.outrogroups?.delete(n));t.outrogroups.size===0&&(t.outrogroups=null)}if(r!==null||s!==void 0){var l=[];if(s!==void 0)for(e of s)(e.f&Y)===0&&l.push(e);for(;r!==null;)(r.f&Y)===0&&r!==t.fallback&&l.push(r),r=r.next;var c=l.length;if(c>0){var v=null;qe(t,l,v)}}}function He(t,i,a,g,x,h,u,r){var s=(u&Ee)!==0?(u&Se)===0?V(a,!1,!1):te(a):null,o=(u&Ce)!==0?te(x):null;return{v:s,i:o,e:G(()=>(h(i,s??a,o??x,r),()=>{t.delete(g)}))}}function D(t,i,a){if(t.nodes)for(var g=t.nodes.start,x=t.nodes.end,h=i&&(i.f&$)===0?i.nodes.start:a;g!==null;){var u=Te(g);if(h.before(g),g===x)return;g=u}}function R(t,i,a){i===null?t.effect.first=a:i.next=a,a===null?t.effect.last=i:a.prev=i}var ze=ce(`<a class="transition first-of-type:mt-2 lg:first-of-type:mt-0 group block
       rounded-xl text-lg px-3 py-2 hover:bg-[var(--btn-plain-bg-hover)] active:bg-[var(--btn-plain-bg-active)]"><div class="transition text-90 inline-flex font-bold group-hover:text-[var(--primary)]"> <!></div> <div class="transition text-xs text-white mb-1 font-mono"> </div> <div class="transition text-sm text-50"><!></div></a>`),Be=ce(`<div id="search-bar" class="hidden lg:flex transition-all items-center h-11 mr-2 rounded-lg
      bg-black/[0.04] hover:bg-black/[0.06] focus-within:bg-black/[0.06]
      dark:bg-white/5 dark:hover:bg-white/10 dark:focus-within:bg-white/10
"><!> <input placeholder="搜索" class="transition-all pl-10 text-sm bg-transparent outline-0
         h-full w-40 active:w-60 focus:w-60 text-black/50 dark:text-white/50 svelte-1wah7ro"/></div> <button aria-label="Search Panel" id="search-switch" class="btn-plain scale-animation lg:!hidden rounded-lg w-11 h-11 active:scale-90"><!></button> <div id="search-panel" class="float-panel float-panel-closed search-panel absolute md:w-[30rem]
top-20 left-4 md:left-[unset] right-4 shadow-2xl rounded-2xl p-2 svelte-1wah7ro"><div id="search-bar-inside" class="flex relative lg:hidden transition-all items-center h-11 rounded-xl
      bg-black/[0.04] hover:bg-black/[0.06] focus-within:bg-black/[0.06]
      dark:bg-white/5 dark:hover:bg-white/10 dark:focus-within:bg-white/10
  "><!> <input placeholder="Search" class="pl-10 absolute inset-0 text-sm bg-transparent outline-0
               focus:w-60 text-black/50 dark:text-white/50 svelte-1wah7ro"/></div> <!></div>`,1);function Je(t,i){Re(i,!1);let a=V(""),g=V(""),x=V([]),h=[];const u=()=>{document.getElementById("search-panel")?.classList.toggle("float-panel-closed")},r=(l,c)=>{const v=document.getElementById("search-panel");!v||!c||(l?v.classList.remove("float-panel-closed"):v.classList.add("float-panel-closed"))},s=(l,c)=>{if(!c)return l;const v=new RegExp(`(${c})`,"gi");return l.replace(v,"<mark>$1</mark>")},o=async(l,c)=>{if(!l){r(!1,c),q(x,[]);return}try{const v=h.filter(n=>{const w=l.toLowerCase(),_=`${n.title} ${n.description} ${n.content}`.toLowerCase(),k=`/posts/${n.link}`;return _.includes(w)||k.toLowerCase().includes(w)||n.link.toLowerCase().includes(w)}).map(n=>{const w=n.content.toLowerCase(),_=l.toLowerCase(),k=w.indexOf(_);let y="";if(k!==-1){const O=Math.max(0,k-50),F=Math.min(n.content.length,k+100);y=n.content.substring(O,F),O>0&&(y="..."+y),F<n.content.length&&(y=y+"...")}else y=n.description||n.content.substring(0,150)+"...";return{url:Oe(`/posts/${n.link}/`),meta:{title:n.title},excerpt:s(y,l),urlPath:`/posts/${n.link}`}});q(x,v),r(p(x).length>0,c)}catch(v){console.error("Search error:",v),q(x,[]),r(!1,c)}finally{}};fe(async()=>{try{const c=await(await fetch("/rss.xml")).text(),w=new DOMParser().parseFromString(c,"text/xml").querySelectorAll("item");h=Array.from(w).map(_=>{let k="";const y=_.getElementsByTagNameNS("*","encoded")[0]?.textContent||_.querySelector("*|encoded")?.textContent||"";return y&&(k=y.replace(/<[^>]*>/g,"")),{title:_.querySelector("title")?.textContent||"",description:_.querySelector("description")?.textContent||"",content:k,link:_.querySelector("link")?.textContent?.replace(/.*\/posts\/(.*?)\//,"$1")||""}})}catch(l){console.error("Error fetching RSS:",l)}}),re(()=>p(a),()=>{o(p(a),!0)}),re(()=>p(g),()=>{o(p(g),!1)}),Me(),ue();var d=Be(),f=Ae(d),E=A(f);H(E,{icon:"material-symbols:search",class:"absolute text-[1.25rem] pointer-events-none ml-3 transition my-auto text-black/30 dark:text-white/30"});var I=M(E,2);X(I),N(f);var e=M(f,2),m=A(e);H(m,{icon:"material-symbols:search",class:"text-[1.25rem]"}),N(e);var T=M(e,2),S=A(T),b=A(S);H(b,{icon:"material-symbols:search",class:"absolute text-[1.25rem] pointer-events-none ml-3 transition my-auto text-black/30 dark:text-white/30"});var C=M(b,2);X(C),N(S);var L=M(S,2);De(L,1,()=>p(x),Pe,(l,c)=>{var v=ze(),n=A(v),w=A(n,!0),_=M(w);H(_,{icon:"fa6-solid:chevron-right",class:"transition text-[0.75rem] translate-x-1 my-auto text-[var(--primary)]"}),N(n);var k=M(n,2),y=A(k,!0);N(k);var O=M(k,2),F=A(O);de(F,()=>(p(c),B(()=>p(c).excerpt))),N(O),N(v),$e(()=>{ve(v,"href",(p(c),B(()=>p(c).url))),le(w,(p(c),B(()=>p(c).meta.title))),le(y,(p(c),B(()=>p(c).urlPath)))}),ae(l,v)}),N(T),Q(I,()=>p(a),l=>q(a,l)),ne("focus",I,()=>o(p(a),!0)),ne("click",e,u),Q(C,()=>p(g),l=>q(g,l)),ae(t,d),Ne()}export{Je as default};
